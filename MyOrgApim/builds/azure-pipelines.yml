# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
  paths:
    include:
      - MyOrgApim
  branches:
    include:
      - master

stages:
  - stage: buildstage
    displayName: Build
    jobs:
      - job: buildcontainer
        displayName: Create Container
        pool:
          vmImage: 'ubuntu-latest'
        steps:
          - task: Docker@2 
            displayName: Login to Docker Hub
            inputs:
              command: login
              containerRegistry: xximjasonxx-dockerhub

          - task: Docker@2
            displayName: Build and Push to Docker Hub
            inputs:
              command: buildAndPush
              Dockerfile: Dockerfile
              buildContext: $(Build.SourcesDirectory)/MyOrgApim
              repository: xximjasonxx/peopleapi
              tags: |
                $(Build.BuildId)